% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/identify_core_microbiome.R
\name{identify_core_microbiome}
\alias{identify_core_microbiome}
\title{Identify Core Microbiome}
\usage{
identify_core_microbiome(
  otu_table,
  metadata,
  sample_col,
  group_col = "group",
  n_ranked = 500,
  threshold = 0.02
)
}
\arguments{
\item{otu_table}{A numeric matrix or data frame with OTUs/ASVs as rows and
samples as columns. Row names should be OTU/ASV identifiers.}

\item{metadata}{A data frame containing sample metadata with a column
matching \code{sample_col} and a grouping column specified by \code{group_col}.}

\item{sample_col}{Character string. Name of the column in \code{metadata}
that contains sample identifiers matching column names in \code{otu_table}.}

\item{group_col}{Character string. Name of the column in \code{metadata}
used for grouping samples (e.g., "treatment", "timepoint"). Default is "group".}

\item{n_ranked}{Integer. Number of top-ranked OTUs to evaluate for core
membership. Default is 500.}

\item{threshold}{Numeric. Threshold for determining core cutoff using the
"last increase" method. Represents the minimum proportional increase in
Bray-Curtis dissimilarity (e.g., 0.02 = 2% increase). Default is 0.02.}
}
\value{
A list with class "core_microbiome" containing:
  \item{elbow}{Integer. Core size determined by elbow method}
  \item{last_call}{Integer. Core size determined by last increase method}
  \item{neutral_model}{Data frame with neutral model predictions}
  \item{ranked_otus}{Data frame of ranked OTUs with dissimilarity metrics}
  \item{fitting_results}{Data frame combining ranking and neutral model results}
  \item{plot_ranked}{ggplot object showing ranked OTUs}
  \item{plot_neutral}{ggplot object showing neutral model fit}
}
\description{
Identify core microbiome members using occurrence frequency, relative abundance,
and neutral model fitting. Combines multiple approaches to robustly define
which taxa constitute the core microbiome.
}
\details{
This function implements a multi-step approach to identify core microbiome members:

\enumerate{
  \item \strong{Ranking}: OTUs are ranked by an index combining occurrence
    frequency and consistency across groups
  \item \strong{Contribution}: Calculates each OTU's contribution to
    community dissimilarity using Bray-Curtis distances
  \item \strong{Cutoff determination}: Uses two methods:
    \itemize{
      \item Elbow method (first-order difference)
      \item Last increase method (based on threshold parameter)
    }
  \item \strong{Neutral model}: Fits Sloan's neutral model to assess
    whether taxa follow neutral expectations
}
}
\examples{
library(bioRtools)
\dontrun{
# Prepare data
otu_data <- matrix(rpois(1000, 10), nrow = 100, ncol = 10)
rownames(otu_data) <- paste0("OTU", 1:100)
colnames(otu_data) <- paste0("Sample", 1:10)

metadata <- data.frame(
  sample_id = paste0("Sample", 1:10),
  group = rep(c("A", "B"), each = 5)
)

# Identify core microbiome
core_result <- identify_core_microbiome(
  otu_table = otu_data,
  metadata = metadata,
  sample_col = "sample_id",
  group_col = "group",
  n_ranked = 50,
  threshold = 0.02
)

# View results
print(core_result)
core_result$plot_ranked
core_result$plot_neutral
}

}
\author{
Xiang LI \email{lixiang117423@foxmail.com}
}
