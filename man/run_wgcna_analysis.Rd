% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_wgcna.R
\name{run_wgcna_analysis}
\alias{run_wgcna_analysis}
\title{WGCNA Co-expression Network Analysis}
\usage{
run_wgcna_analysis(
  expression_file,
  sample_info_file,
  output_dir,
  trait_columns,
  gene_id_col = "gene_id",
  sample_col = "sample",
  fpkm_col = "FPKM",
  sample_id_col = "treatment",
  min_gene_sd = 0.1,
  power_vector = 1:30,
  min_module_size = 50,
  max_block_size = NULL,
  tom_type = "signed",
  correlation_method = "pearson",
  save_network = TRUE,
  plot_width = 12,
  plot_height = 6,
  plot_dpi = 500
)
}
\arguments{
\item{expression_file}{Path to the expression data file (tab-delimited)}

\item{sample_info_file}{Path to the sample information file (Excel format)}

\item{output_dir}{Output directory for saving results and plots}

\item{trait_columns}{Character vector of column names in sample info to use for trait association}

\item{gene_id_col}{Column name containing gene IDs in expression data (default: "gene_id")}

\item{sample_col}{Column name containing sample IDs in expression data (default: "sample")}

\item{fpkm_col}{Column name containing expression values (default: "FPKM")}

\item{sample_id_col}{Column name containing sample IDs in sample info (default: "treatment")}

\item{min_gene_sd}{Minimum standard deviation threshold for gene filtering (default: 0.1)}

\item{power_vector}{Vector of powers to test for soft threshold (default: 1:30)}

\item{min_module_size}{Minimum number of genes in a module (default: 50)}

\item{max_block_size}{Maximum block size for module detection (default: NULL, uses all genes)}

\item{tom_type}{Type of TOM (Topological Overlap Matrix) to use (default: "signed")}

\item{correlation_method}{Correlation method for module-trait association (default: "pearson")}

\item{save_network}{Whether to save the network object as RData file (default: TRUE)}

\item{plot_width}{Width of saved plots in inches (default: 12)}

\item{plot_height}{Height of saved plots in inches (default: 6)}

\item{plot_dpi}{DPI for saved plots (default: 500)}
}
\value{
A list containing:
\itemize{
  \item \code{network}: The WGCNA network object
  \item \code{module_colors}: Module color assignments for genes
  \item \code{module_trait_cor}: Module-trait correlation matrix
  \item \code{module_trait_pvalue}: Module-trait p-value matrix
  \item \code{soft_power}: Selected soft threshold power
  \item \code{gene_module_mapping}: Data frame mapping genes to modules
  \item \code{module_eigengenes}: Module eigengenes matrix
}
}
\description{
A comprehensive function to perform WGCNA (Weighted Gene Co-expression Network Analysis)
including data preprocessing, network construction, module identification, and 
module-trait association analysis.
}
\details{
This function performs a complete WGCNA pipeline:
1. Data loading and preprocessing with log2 transformation
2. Quality control and gene filtering based on standard deviation
3. Soft threshold power selection for scale-free topology
4. Network construction and module identification
5. Module-trait association analysis
6. Generation of various plots and output files
}
\examples{
\dontrun{
# Basic WGCNA analysis
result <- run_wgcna_analysis(
  expression_file = "expression_data.txt",
  sample_info_file = "sample_info.xlsx", 
  output_dir = "wgcna_results",
  trait_columns = c("time", "strain")
)

# View module-trait correlations
print(result$module_trait_cor)

# Access network object
network <- result$network
}

}
