% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_synteny.R
\name{plot_synteny}
\alias{plot_synteny}
\title{Create Gene Synteny Plot Using ggplot2}
\usage{
plot_synteny(
  gene_data,
  syntenic_data = NULL,
  start_col = "start",
  end_col = "end",
  y_col = "y",
  gene_name_col = "gene_name",
  species_col = "species",
  direction_col = "direction",
  gene_type_col = "gene_type",
  x_col = "x",
  y_synt_col = "y",
  group_col = "group",
  synteny_groups = NULL,
  syn_group_col = "syn_group",
  species_labels = NULL,
  fill_colors = c("#e59f01", "#56b4e8", "#009f73", "#0072b1"),
  link_color = "grey",
  link_alpha = 0.5,
  link_strength = 0.5,
  link_type = "ribbon",
  gene_arrow_height = 3,
  gene_arrow_width = 1.5,
  show_gene_labels = TRUE,
  gene_label_fontface = "italic",
  axis_text_italic = TRUE,
  title = NULL,
  subtitle = NULL
)
}
\arguments{
\item{gene_data}{Data frame containing gene information. Must include columns:
\itemize{
  \item start: Gene start position (numeric)
  \item end: Gene end position (numeric)
  \item y: Y-axis position for the gene (numeric, typically 1, 2, 3, etc.)
  \item gene_name: Gene name/identifier (character)
  \item species: Species name (character)
  \item direction: Gene strand direction (character, "+" or "-")
  \item gene_type: Gene category for coloring (character)
}}

\item{syntenic_data}{Data frame containing synteny relationships between genes.
Must include columns:
\itemize{
  \item x: X-coordinate (numeric)
  \item y: Y-coordinate (numeric)
  \item group: Grouping variable for connecting homologous genes (character/numeric)
}
For ribbon-style links (link_type = "ribbon"), each group must have 4 rows
defining the corners of the link region. For curve-style links (link_type = "curve"),
each group must have 2 rows defining the start and end points.
If NULL, syntenic_data will be automatically generated from synteny_groups parameter.
Default is NULL.}

\item{start_col}{Character string specifying the column name for gene start position.
Default is "start".}

\item{end_col}{Character string specifying the column name for gene end position.
Default is "end".}

\item{y_col}{Character string specifying the column name for y-axis position.
Default is "y".}

\item{gene_name_col}{Character string specifying the column name for gene names.
Default is "gene_name".}

\item{species_col}{Character string specifying the column name for species.
Default is "species".}

\item{direction_col}{Character string specifying the column name for gene direction.
Default is "direction".}

\item{gene_type_col}{Character string specifying the column name for gene categories.
Default is "gene_type".}

\item{x_col}{Character string specifying the column name for x-coordinate in syntenic_data.
Default is "x".}

\item{y_synt_col}{Character string specifying the column name for y-coordinate in syntenic_data.
Default is "y".}

\item{group_col}{Character string specifying the column name for grouping in syntenic_data.
Default is "group".}

\item{synteny_groups}{Named list or vector defining homologous gene groups.
Each element contains gene names that should be connected as syntenic.
For example: list(group1 = c("Gene1", "Gene2", "Gene3"), group2 = c("Gene4", "Gene5")).
If provided, syntenic_data will be automatically generated. Ignored if syntenic_data is provided.
Default is NULL.}

\item{syn_group_col}{Character string specifying the column name in gene_data that
contains synteny group identifiers. If provided and syntenic_data is NULL,
syntenic_data will be automatically generated from this column. This is more convenient
than synteny_groups when group information is already in the gene_data (e.g., from Excel).
Default is "syn_group".}

\item{species_labels}{Character vector of labels for species on y-axis.
Default is NULL (automatically uses species column values from gene_data).}

\item{fill_colors}{Character vector of colors for gene types.
Default is c("#e59f01", "#56b4e8", "#009f73", "#0072b1").}

\item{link_color}{Character string specifying the color for synteny links.
Default is "grey".}

\item{link_alpha}{Numeric value between 0 and 1 for link transparency.
Default is 0.5.}

\item{link_strength}{Numeric value controlling the curvature of links.
For ribbon links, controls the "bulge" of the diagonal. For curve links,
controls the curvature. Default is 0.5.}

\item{link_type}{Character string specifying the style of synteny links.
Options: "ribbon" for filled ribbon-style links (requires 4 points per group)
or "curve" for simple curved lines (requires 2 points per group). Default is "ribbon".}

\item{gene_arrow_height}{Numeric value for gene arrow head height in mm.
Default is 3.}

\item{gene_arrow_width}{Numeric value for gene arrow head width in mm.
Default is 1.5.}

\item{show_gene_labels}{Logical indicating whether to display gene names.
Default is TRUE.}

\item{gene_label_fontface}{Character string specifying font face for gene labels.
Options: "plain", "bold", "italic", "bold.italic". Default is "italic".}

\item{axis_text_italic}{Logical indicating whether y-axis species labels should be italic.
Default is TRUE.}

\item{title}{Character string for plot title. Default is NULL.}

\item{subtitle}{Character string for plot subtitle. Default is NULL.}
}
\value{
A list containing two components:
\describe{
  \item{plot.synteny}{A ggplot object displaying the gene synteny plot.}
  \item{data.summary}{A summary table showing the number of genes and links
    per species.}
}
}
\description{
Create a publication-quality gene synteny plot to visualize conserved
gene order and collinearity between multiple species/genomes. This function
uses gggenes and ggforce packages to draw genes as arrows and connect
homologous genes with Bezier curves.
}
\details{
This function creates a gene synteny plot commonly used in comparative genomics
to visualize conserved gene order and collinear relationships between species.

The plot consists of:
\itemize{
  \item Genes displayed as arrows pointing in the direction of transcription
  \item Species arranged on separate horizontal tracks
  \item Bezier curves connecting homologous genes between species
  \item Color coding by gene type/category
}

The function automatically adjusts gene positions to prevent overlap between
species tracks. For custom positioning, users should pre-process the gene_data
to manually set y-coordinates.
}
\note{
This function requires the gggenes and ggforce packages. Install them using:
\code{install.packages("gggenes")} and \code{install.packages("ggforce")}.

The syntenic_data must be manually prepared to specify which genes should be
connected. Each row represents one connection between two genes.
}
\examples{
library(bioRtools)

# Load example data
data(df.synteny.gene)
data(df.synteny.link)

# Create basic synteny plot
synteny_result <- plot_synteny(
  gene_data = df.synteny.gene,
  syntenic_data = df.synteny.link,
  species_labels = c("A", "B", "C", "D")
)

# Display the plot
synteny_result$plot.synteny

# View summary statistics
synteny_result$data.summary

# Customized plot with different colors
plot_synteny(
  gene_data = df.synteny.gene,
  syntenic_data = df.synteny.link,
  species_labels = c("Sp1", "Sp2", "Sp3", "Sp4"),
  fill_colors = c("#FF6B6B", "#4ECDC4", "#45B7D1", "#FFA07A"),
  link_color = "grey50",
  link_alpha = 0.3,
  title = "Gene Synteny Analysis",
  subtitle = "Cross-species comparison"
)$plot.synteny

# Automatic syntenic data generation using synteny_groups
plot_synteny(
  gene_data = df.synteny.gene,
  synteny_groups = list(
    group1 = c("Gene03", "Gene06", "Gene09", "Gene12"),
    group2 = c("Gene04", "Gene07", "Gene10", "Gene13"),
    group3 = c("Gene02", "Gene05", "Gene11", "Gene14")
  ),
  species_labels = c("A", "B", "C", "D")
)$plot.synteny

# Easiest method: use syn_group column from gene_data
# If your data has a "syn_group" column, simply call:
plot_synteny(
  gene_data = df.synteny.gene
  # syntenic_data is auto-generated from syn_group column
  # species_labels are auto-generated from species column
)$plot.synteny

}
\references{
This function is inspired by the synteny plots commonly seen in comparative
genomics papers, particularly in CELL, Nature, and Science journals.
}
\author{
Xiang LI \email{lixiang117423@foxmail.com}
}
