% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_expression_standard_curve.R
\name{calc_expression_standard_curve}
\alias{calc_expression_standard_curve}
\title{Calculate Gene Expression Using Standard Curve Method}
\usage{
calc_expression_standard_curve(
  cq_table,
  curve_table,
  design_table,
  normalize_by_reference = TRUE,
  reference_gene = "OsUBQ",
  statistical_method = "t.test",
  reference_group = "CK",
  plot_type = "box",
  plot_ncol = NULL
)
}
\arguments{
\item{cq_table}{A data frame containing position and Cq values.
Must contain columns: Position, Cq}

\item{curve_table}{A data frame containing standard curve parameters for each gene.
Must contain columns: Gene, Slope, Intercept, min.Cq, max.Cq}

\item{design_table}{A data frame containing experimental design information.
Must contain columns: Position, Treatment (or Group), Gene}

\item{normalize_by_reference}{Logical indicating whether to normalize expression
values by reference gene (default: TRUE)}

\item{reference_gene}{Character string specifying the reference gene name
(default: "OsUBQ")}

\item{statistical_method}{Statistical method for group comparisons.
Options: "t.test", "wilcox.test", "anova" (default: "t.test")}

\item{reference_group}{Character string specifying the reference group for
statistical comparisons (default: "CK")}

\item{plot_type}{Type of plot to generate. Options: "box", "bar" (default: "box")}

\item{plot_ncol}{Number of columns in faceted plot (default: NULL for auto)}
}
\value{
A list containing:
  \item{expression_data}{Data frame with calculated expression values and statistics}
  \item{summary_table}{Summary statistics by group and gene}
  \item{statistical_results}{Statistical test results}
  \item{curve_warnings}{Warnings about Cq values outside curve range}
  \item{plot}{ggplot object showing expression levels}
}
\description{
This function calculates gene expression levels using standard curves,
with optional normalization to a reference gene and statistical comparisons
between treatment groups.
}
\examples{
# Load example data
cq_data_path <- system.file("extdata/qPCR", "cal.exp.curve.cq.txt", package = "bioRtools")
curve_data_path <- system.file("extdata/qPCR", "cal.expre.curve.sdc.txt", package = "bioRtools")
design_data_path <- system.file("extdata/qPCR", "cal.exp.curve.design.txt", package = "bioRtools")

cq_data <- read.table(cq_data_path, header = TRUE)
curve_data <- read.table(curve_data_path, sep = "\t", header = TRUE)
design_data <- read.table(design_data_path, header = TRUE)

# Calculate expression using standard curves
result <- calc_expression_standard_curve(
  cq_table = cq_data,
  curve_table = curve_data,
  design_table = design_data,
  normalize_by_reference = TRUE,
  reference_gene = "OsUBQ",
  statistical_method = "t.test",
  reference_group = "CK",
  plot_type = "box"
)

# View results
result$summary_table
result$statistical_results
result$plot

}
\author{
Xiang LI <lixiang117423@gmail.com>
}
