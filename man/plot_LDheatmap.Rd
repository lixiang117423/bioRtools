% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_LDheatmap.R
\name{plot_LDheatmap}
\alias{plot_LDheatmap}
\title{Create a linkage disequilibrium (LD) heatmap from VCF file}
\usage{
plot_LDheatmap(
  vcf_file,
  color_palette = "default",
  color_steps = 100,
  flip_diagonal = TRUE,
  title = NULL,
  subtitle = NULL,
  output_file = NULL,
  file_format = "png",
  width = 9,
  height = 7,
  dpi = 300,
  ggplot_version = TRUE,
  show_values = FALSE,
  text_size = 3,
  verbose = TRUE
)
}
\arguments{
\item{vcf_file}{Character string specifying the path to the VCF file in PLINK format.
The file should contain SNP genotype data.}

\item{color_palette}{Character string or vector specifying the color scheme. Options include:
\itemize{
  \item "default": Soft green gradient (publication-ready)
  \item "green_yellow": Green to yellow gradient similar to your image
  \item "scientific": Blue-green gradient for scientific publications
  \item "nature": Nature journal style color scheme
  \item "cell": Cell journal style green gradient
  \item "viridis": Viridis color scale
  \item "plasma": Plasma color scale
  \item "magma": Magma color scale
  \item "red_blue": Blue to white to red diverging scale
  \item Custom vector: User-provided color vector (e.g., c("#f7fcf5", "#238b45"))
}}

\item{color_steps}{Integer specifying the number of color steps in the palette. 
Default is 100.}

\item{flip_diagonal}{Logical indicating whether to flip the heatmap along the diagonal.
Default is TRUE.}

\item{title}{Character string for the plot title. If NULL, a default title will be generated.
Default is NULL.}

\item{subtitle}{Character string for the plot subtitle. Default is NULL.}

\item{output_file}{Character string specifying the output filename (without extension).
If NULL, the plot will only be displayed. Default is NULL.}

\item{file_format}{Character string specifying the output format. Options include:
"png", "pdf", "jpeg", "tiff". Default is "png".}

\item{width}{Numeric value for plot width. For raster formats (png, jpeg, tiff), 
this is in pixels when multiplied by dpi. For PDF, this is in inches. Default is 9.}

\item{height}{Numeric value for plot height. For raster formats (png, jpeg, tiff), 
this is in pixels when multiplied by dpi. For PDF, this is in inches. Default is 7.}

\item{dpi}{Numeric value for resolution (dots per inch) for raster formats. 
Default is 300.}

\item{ggplot_version}{Logical indicating whether to create a ggplot2 version 
of the heatmap in addition to the LDheatmap version. Default is TRUE.}

\item{show_values}{Logical indicating whether to show LD values in the ggplot2 
heatmap tiles. Default is FALSE (recommended for large datasets).}

\item{text_size}{Numeric value for text size in ggplot2 version when show_values = TRUE.
Default is 3.}
}
\value{
A list containing:
\describe{
  \item{plot.ld_heatmap}{The LD heatmap plot object from LDheatmap package}
  \item{plot.ggplot2}{A ggplot2 version of the heatmap (if ggplot_version = TRUE)}
  \item{ld.matrix}{The linkage disequilibrium matrix (rÂ²) used for plotting}
  \item{snp.matrix}{The SNP genotype matrix used for LD calculation}
  \item{genetic.distances}{The genetic distances vector}
  \item{snp.info}{Information about the SNPs including positions}
  \item{plot.params}{Parameters used for plotting (colors, dimensions, etc.)}
}
}
\description{
Generate a linkage disequilibrium heatmap directly from a VCF file in PLINK format.
This function provides a convenient way to visualize LD patterns across genomic regions
with customizable color schemes and output options.
}
\details{
This function reads VCF files in PLINK format and generates LD heatmaps using the
LDheatmap package. The function provides several built-in color palettes optimized
for LD visualization, where higher LD values (closer to 1) are typically shown in
"hotter" colors.

The function automatically handles:
\itemize{
  \item SNP matrix extraction from VCF files
  \item Genetic distance calculation
  \item Color palette generation
  \item File output in multiple formats
  \item Plot parameter optimization
}
}
\note{
This function requires the LDheatmap package and ttplot package for VCF file processing.
If LDheatmap is not installed, it will be installed automatically from Bioconductor.
}
\examples{
\dontrun{
# Basic LD heatmap with default settings
ld_result <- plot_LDheatmap(
  vcf_file = "path/to/your/file.vcf",
  title = "LD Heatmap for Chr1:1000000-2000000"
)

# Display the plot
ld_result$plot.ld_heatmap

# Custom color palette matching your image style
ld_soft <- plot_LDheatmap(
  vcf_file = "path/to/your/file.vcf",
  color_palette = "green_yellow",
  title = "LD Analysis with Soft Green-Yellow Colors"
)

# Nature journal style
ld_nature <- plot_LDheatmap(
  vcf_file = "path/to/your/file.vcf",
  color_palette = "nature",
  title = "Publication-Ready LD Heatmap"
)

# Custom hex colors for precise control
ld_custom_hex <- plot_LDheatmap(
  vcf_file = "path/to/your/file.vcf",
  color_palette = c("#f7fcf5", "#c7e9c0", "#74c476", "#238b45", "#00441b"),
  title = "Custom Green Gradient LD Analysis"
)

# Save ggplot2 version with ggsave
ld_ggplot <- plot_LDheatmap(
  vcf_file = "path/to/your/file.vcf",
  color_palette = "green_yellow",
  ggplot_version = TRUE,
  title = "LD Heatmap Analysis"
)

# Save the ggplot2 version
ggplot2::ggsave("ld_heatmap.png", ld_ggplot$plot.ggplot2, 
                width = 10, height = 8, dpi = 300)
ggplot2::ggsave("ld_heatmap.pdf", ld_ggplot$plot.ggplot2, 
                width = 10, height = 8)

# Customize the ggplot2 version further
custom_plot <- ld_ggplot$plot.ggplot2 +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    axis.text.x = ggplot2::element_text(angle = 45, hjust = 1),
    plot.title = ggplot2::element_text(size = 16, face = "bold")
  ) +
  ggplot2::labs(
    caption = "Generated with bioRtools::plot_LDheatmap()"
  )

ggplot2::ggsave("ld_heatmap_custom.png", custom_plot, 
                width = 12, height = 10, dpi = 300)

# Multiple format output with soft colors
ld_multi <- plot_LDheatmap(
  vcf_file = "path/to/your/file.vcf",
  color_palette = "scientific",
  color_steps = 150,
  output_file = "ld_heatmap_final",
  file_format = "png",
  dpi = 600,
  verbose = TRUE
)
}

}
