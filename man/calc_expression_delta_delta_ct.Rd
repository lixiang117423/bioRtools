% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_expression_delta_delta_ct.R
\name{calc_expression_delta_delta_ct}
\alias{calc_expression_delta_delta_ct}
\title{Calculate Gene Expression Using Delta-Delta Ct Method}
\usage{
calc_expression_delta_delta_ct(
  cq_table,
  design_table,
  reference_gene = "OsUBQ",
  reference_group = "CK",
  statistical_method = "t.test",
  remove_outliers = TRUE,
  plot_type = "box",
  plot_ncol = NULL
)
}
\arguments{
\item{cq_table}{A data frame containing position and Cq values.
Must contain columns: Position, Cq}

\item{design_table}{A data frame containing experimental design information.
Must contain columns: Position, Group, Gene, BioRep}

\item{reference_gene}{Character string specifying the reference gene name
(default: "OsUBQ")}

\item{reference_group}{Character string specifying the reference group name
(default: "CK")}

\item{statistical_method}{Statistical method for group comparisons.
Options: "t.test", "wilcox.test", "anova" (default: "t.test")}

\item{remove_outliers}{Logical indicating whether to remove outliers using
IQR method (default: TRUE)}

\item{plot_type}{Type of plot to generate. Options: "box", "bar" (default: "box")}

\item{plot_ncol}{Number of columns in faceted plot (default: NULL for auto)}
}
\value{
A list containing:
  \item{expression_data}{Data frame with calculated expression values and statistics}
  \item{summary_table}{Summary statistics by group and gene}
  \item{statistical_results}{Statistical test results}
  \item{plot}{ggplot object showing expression levels}
}
\description{
This function calculates relative gene expression using the delta-delta Ct
method (2^-ddCt), which normalizes target gene expression to a reference
gene and compares to a reference group.
}
\examples{
# Load example data
cq_data_path <- system.file("extdata/qPCR", "ddct.cq.txt", package = "bioRtools")
design_data_path <- system.file("extdata/qPCR", "ddct.design.txt", package = "bioRtools")
cq_data <- read.table(cq_data_path, header = TRUE)
design_data <- read.table(design_data_path, header = TRUE)

# Calculate expression using delta-delta Ct method
result <- calc_expression_delta_delta_ct(
  cq_table = cq_data,
  design_table = design_data,
  reference_gene = "OsUBQ",
  reference_group = "CK",
  statistical_method = "t.test",
  remove_outliers = TRUE,
  plot_type = "bar"
)

# View results
result$summary_table
result$statistical_results
result$plot

}
\author{
Xiang LI <lixiang117423@gmail.com>
}
