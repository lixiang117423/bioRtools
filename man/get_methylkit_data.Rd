% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_methylkit_data.R
\name{get_methylkit_data}
\alias{get_methylkit_data}
\title{从methylKit对象提取全面的甲基化数据（包含上下文信息）}
\usage{
get_methylkit_data(
  methyl_obj,
  context = "CpG",
  lo.count = 5,
  lo.perc = NULL,
  hi.count = NULL,
  hi.perc = 100,
  destrand = FALSE
)
}
\arguments{
\item{methyl_obj}{一个 `methylRawList` 对象。}

\item{context}{字符型。甲基化的序列上下文（如 "CpG", "CHG", 或 "CHH"）。
此信息将被添加为输出数据框的一列。默认为 "CpG"。}

\item{lo.count}{数值。最低覆盖度阈值，默认为 10。}

\item{lo.perc}{数值。要过滤掉的覆盖度值的较低百分位数。默认为 NULL。}

\item{hi.count}{数值。用于过滤的最高覆盖度阈值。默认为 NULL。}

\item{hi.perc}{数值。最高覆盖度百分位数，用于去除异常值，默认为 99.9。}

\item{destrand}{逻辑值。是否合并正负链数据，默认为 FALSE。}
}
\value{
一个综合性的数据框，包含：
        - chr, start, end, strand: 位点信息。
        - context: 甲基化上下文类型。
        - 对每个样本，有四列：[样本名]_coverage, [样本名]_numCs, [样本名]_numTs, [样本名]_meth_percent。
}
\description{
该函数接收一个methylKit对象，进行过滤和标准化，然后生成一个包含
             完整信息的宽格式数据框。对于每个样本，它会保留原始的覆盖度(coverage)、
             甲基化C(numCs)、未甲基化C(numTs)计数，并计算甲基化百分比。
             所有与样本相关的列都将使用'样本名_数据类型'的格式进行命名。
}
\examples{
\dontrun{
library(tidyverse)
library(methylKit)
# 1. 创建模拟数据 (这部分代码是正确的，无需修改)
mock_data1 <- data.frame(
  chr = "chr1", start = 1001:1005, end = 1001:1005, strand = "+",
  coverage = c(100, 120, 90, 150, 200),
  numCs = c(10, 60, 5, 75, 20),
  numTs = 0
)
mock_data1$numTs <- mock_data1$coverage - mock_data1$numCs

mock_data2 <- data.frame(
  chr = "chr1", start = 1001:1005, end = 1001:1005, strand = "+",
  coverage = c(110, 130, 80, 160, 210),
  numCs = c(55, 13, 40, 16, 189),
  numTs = 0
)
mock_data2$numTs <- mock_data2$coverage - mock_data2$numCs
# 步骤 A: 为第一个样本创建 methylRaw 对象
obj1 <- methRead(
  location = mock_data1,    # 直接读取 data.frame
  sample.id = "CK1",
  assembly = "hg19",
  dbtype = "tabix",          # 推荐使用 tabix 格式，效率更高
  dbdir = "methylDB_example" # 指定一个文件夹存放数据库文件
)

# 步骤 B: 为第二个样本创建 methylRaw 对象
obj2 <- methRead(
  location = mock_data2,
  sample.id = "Treat1",
  assembly = "hg19",
  dbtype = "tabix",
  dbdir = "methylDB_example"
)

# 步骤 C: 将创建好的对象组合成 methylRawList
my_cpg_obj <- methylRawList(
  obj1,
  obj2,
  treatment = c(0, 1) # 0 代表对照组 (CK1), 1 代表处理组 (Treat1)
)

print(my_cpg_obj)
comprehensive_cpg_table <- get_methylkit_data(
  methyl_obj = my_cpg_obj,
  context = "CpG",
  lo.count = 10
)
# 3. 查看最终结果
#    注意新增了 context 列
print(comprehensive_cpg_table)
}

}
