% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_expression_qpcr_efficiency.R
\name{calc_expression_qpcr_efficiency}
\alias{calc_expression_qpcr_efficiency}
\title{Calculate Gene Expression Using qPCR with Efficiency Correction}
\usage{
calc_expression_qpcr_efficiency(
  cq_table,
  design_table,
  reference_gene = NULL,
  reference_group = "CK",
  statistical_method = "t.test",
  plot_type = "box",
  plot_ncol = NULL
)
}
\arguments{
\item{cq_table}{A data frame containing qPCR data.
Must contain columns: Position, Cq, Gene}

\item{design_table}{A data frame containing experimental design information.
Must contain columns: Position, Group, BioRep, TechRep, Eff}

\item{reference_gene}{Character vector of reference gene names.
If NULL, the most stable genes will be selected automatically}

\item{reference_group}{Character string specifying the reference group for
statistical comparisons (default: "CK")}

\item{statistical_method}{Statistical method for group comparisons.
Options: "t.test", "wilcox.test", "anova" (default: "t.test")}

\item{plot_type}{Type of plot to generate. Options: "box", "bar" (default: "box")}

\item{plot_ncol}{Number of columns in faceted plot (default: NULL for auto)}
}
\value{
A list containing:
  \item{table}{Data frame with calculated expression values and statistics}
  \item{figure}{ggplot object showing expression levels}
}
\description{
Calculate expression using qPCR with efficiency correction and automatic
reference gene selection using GeNorm algorithm if reference genes are not specified.
This function preserves the original algorithm logic from the author.
}
\examples{
# Load example data
cq_data_path <- system.file("examples", "cal.expre.rqpcr.cq.txt", package = "qPCRtools")
design_data_path <- system.file("examples", "cal.expre.rqpcr.design.txt", package = "qPCRtools")

cq_data <- read.table(cq_data_path, header = TRUE)
design_data <- read.table(design_data_path, header = TRUE)

# Calculate expression
result <- calc_expression_qpcr_efficiency(
  cq_table = cq_data,
  design_table = design_data,
  reference_gene = NULL,  # Automatic selection
  reference_group = "CK",
  statistical_method = "t.test",
  plot_type = "box"
)

# View results
result$table
result$figure

}
\author{
Xiang LI <lixiang117423@gmail.com>
}
